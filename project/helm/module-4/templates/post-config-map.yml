apiVersion: v1
kind: ConfigMap
metadata:
  name: vdm-post-config-map
  namespace: {{.Values.namespace}}
  labels: {{- include "helpers.labels" . | nindent 4}}

data:
  post_server_db_host: "post-postgres-service"
  port_server_db_port: "5432"
  post_server_db_name: "vdm_database_posts"
  post_server_user_server_url: "http://user-service:8081"
  pgdata: "/data/postgres"

  init.posts.db: |    
    CREATE SCHEMA vdm_posts AUTHORIZATION root;  
    CREATE TABLE vdm_posts.posts (
    post_id         int8         NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    author_id       int8         NOT NULL,
    "text"          varchar(400) NULL,
    "topic"         varchar(400) NULL,
    posted_at       timestamp    NOT NULL DEFAULT (now() AT TIME ZONE 'utc'::text),
    CONSTRAINT post_id_pk PRIMARY KEY (post_id)
    );
    



